[
  {
    "path": "r_posts/2022-08-22-Bayesian/",
    "title": "A Bayes Application and made up examples",
    "description": "Keywords: Bayes Theorem, Bayesian application, Bayes interpretation.",
    "author": [
      {
        "name": "Yiwen Wu",
        "url": {}
      }
    ],
    "date": "2022-08-22",
    "categories": [],
    "contents": "\nThis post is my own practice and preparation of using/applying\nBayesian regression. Material and example codes are from John\nMyles White.\nThe first step is to create a set of data that fulfills the following\nrequirements: Gaussian distributed with equal variance and a meang which\nis a linear function of the predictors.\n\n    b_length    b_mass\n1 -2.6564554  5.712696\n2 -2.4404669  9.119517\n3 -1.7813084 17.362433\n4 -1.7631631  9.323737\n5 -1.3888607 18.636169\n6 -0.6399949 15.015008\n\nNow, before analyzing, convert to the list format. The list will have\nthree elements, body mass, body length, and a number that indicates the\nsample size.\nWrite JAGS model. Create the model with JAGS code, there are\ndifferences between R and JAGS code: JAGS use dnorm for distributionâ€™s\nprecision (1/variance). Tilde (~) signifies that object on the left is\nrandom variable distributed according to the distribution on the right.\nAlpha and Beta are intercepts of linear relationships.\n\n\n\nThe initial parameter values for the MCMC. The parameters are chosen\nwhose posterior distributions will be reported and runs the model in\nJAGS.\nThree MCMC chanins with 12000 iterations each, and discards the first\n2000 values, because these first 2000 values highly depend on initial\nvalues.\nn.thin means only every 10th iteration is saved and the rest\ndiscarded.\nModel output. The 2.5% and 97.5% quantile range are the 95% credible\ninterval for each parameter. For the 95% credible interval, there is a\n95% probability that the true parameter lies within this range.\nThe last two columns are convergence diagnostics. n.eff is a number\nsmaller than or equal to the number of samples saved from the chains\n(3*(12000-2000)/10). The higher autocorrelation in the saved samples\nindicate a smaller effective sample size. Rhat indicates how well the\nthree Markov chains are mixed. Ideal Rhat is close to 1. Large Rhat\nvalues mean that chains are not mixed properly and posterior estimates\ncannot be trusted.\n\n\nfit_lm1\n\nInference for Bugs model at \"/var/folders/xj/c74jv4d928z1rmtv4_vchj740000gn/T//RtmpKVxs4V/model158f583cb405.txt\", fit using jags,\n 3 chains, each with 12000 iterations (first 2000 discarded), n.thin = 10\n n.sims = 3000 iterations saved\n      mu.vect sd.vect   2.5%    25%    50%    75%  97.5%  Rhat n.eff\nalpha  29.079   1.038 27.063 28.408 29.101 29.761 31.086 1.002  1800\nbeta    9.736   0.845  8.044  9.199  9.744 10.294 11.342 1.001  3000\nsigma   5.586   0.812  4.275  5.015  5.485  6.074  7.371 1.001  3000\n\nFor each parameter, n.eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor (at convergence, Rhat=1).\n\nThe traceplot is used to visualize how well the chains have mixed. In\nthis case, chains are nicely mixed\n\n\n\nOther ways to demonstrate posterior distributions of parameters\ngraphically.\n\n\n\nVisualize in MCMC format\n\n\n\nIf we change parameters and plot the mcmc visuals, we want to see the\ndifferences when altering.\nCreate\na Catogorical variable (sex) and adding to the jags model\n\n$b_mass\n [1] 19.309795 21.757625  8.176761 18.101959  6.869465 30.544474\n [7] 26.567582 16.759391 28.439164 15.914424 32.568771 21.647253\n[13] 29.606252 28.577468 35.155978 38.940458 23.314439 29.641170\n[19] 33.889166 27.456285 22.908149 27.540421 26.500509 34.466663\n[25] 37.523150 35.058236 34.596614 30.236815 41.302396 30.297417\n[31] 34.570252 35.918447 33.942750 35.541939 39.130491 39.304575\n[37] 39.992016 34.129303 34.527288 32.001647 38.439367 39.583496\n[43] 57.643543 36.390552 44.395866 36.972887 38.228475 48.889866\n[49] 45.201041 50.997405\n\n$b_length\n [1] -2.65645542 -2.44046693 -2.41420765 -1.78130843 -1.76316309\n [6] -1.71700868 -1.38886070 -1.36828104 -0.85090759 -0.81139318\n[11] -0.78445901 -0.72670483 -0.63999488 -0.60892638 -0.56469817\n[16] -0.43144620 -0.43046913 -0.36105730 -0.30663859 -0.28425292\n[21] -0.27878877 -0.25726938 -0.17191736 -0.13332134 -0.10612452\n[26] -0.09465904 -0.06271410  0.03612261  0.20599860  0.36312841\n[31]  0.40426832  0.43281803  0.45545012  0.46009735  0.50495512\n[36]  0.63286260  0.63595040  0.65564788  0.70483734  0.75816324\n[41]  1.03510352  1.21467470  1.30486965  1.32011335  1.37095845\n[46]  1.44410126  1.51152200  1.89519346  2.01842371  2.28664539\n\n$sex\n [1] 1 1 0 1 0 1 1 0 1 0 1 0 1 0 1 1 0 0 0 1 0 1 1 1 1 0 0 1 0 0 0 1 0\n[34] 0 1 1 1 0 0 1 0 0 1 0 0 0 1 1 0 1\n\n$N\n[1] 50\n\nTest\nof increasing the range of data (by increasing the standard deviation 10\ntimes)\n\n\nlm2_jags <- function(){\n  # Likelihood:\n  for (i in 1:N){\n    b_mass[i] ~ dnorm(mu[i], tau) # tau is precision (1 / variance)\n    mu[i] <- alpha[1] + sex[i] * alpha[2] + \n      (beta[1] + beta[2] * sex[i]) * b_length[i]\n  }\n  # Priors:\n  for (i in 1:2){\n    alpha[i] ~ dnorm(0, 0.01) \n    beta[i] ~ dnorm(0, 0.01)  \n  }\n  sigma ~ dunif(0, 1000) \n  tau <- 1 / (sigma * sigma)\n}\n\n# ---------\ninit_values <- function(){\n  list(alpha = rnorm(2), beta = rnorm(2), sigma = runif(1))\n}\n\nparams <- c(\"alpha\", \"beta\", \"sigma\")\n\nfit_lm2 <- jags(data = jagsdata_s2, \n                inits = init_values, \n                parameters.to.save = params, \n                model.file = lm2_jags, n.chains = 3, \n                n.iter = 12000, n.burnin = 2000, n.thin = 10, DIC = F)\n\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 50\n   Unobserved stochastic nodes: 5\n   Total graph size: 268\n\nInitializing model\n\n#--------\nlm2_mcmc <- as.mcmc(fit_lm2)\nplot(lm2_mcmc)\n\n\n\nTest of\nJAGS model with wrong mean but low variance.\n\n$b_mass\n [1] 42.27916 44.07903 20.24780 38.44588 15.68528 50.69550 45.73416\n [8] 23.60080 45.99189 19.97139 49.92215 25.28078 46.52624 31.62210\n[15] 51.85007 55.23480 25.46678 31.44646 35.42236 43.30904 24.30209\n[22] 43.31223 42.01626 49.86663 52.84152 35.53153 34.91018 45.12845\n[29] 40.27240 28.48178 32.54891 49.61999 31.66550 33.24145 52.61563\n[36] 52.40599 53.08417 30.85106 31.00310 44.72716 33.26385 33.51012\n[43] 68.72893 29.78999 37.54107 29.75238 48.69391 58.20429 35.10892\n[50] 59.13747\n\n$b_length\n [1] -2.65645542 -2.44046693 -2.41420765 -1.78130843 -1.76316309\n [6] -1.71700868 -1.38886070 -1.36828104 -0.85090759 -0.81139318\n[11] -0.78445901 -0.72670483 -0.63999488 -0.60892638 -0.56469817\n[16] -0.43144620 -0.43046913 -0.36105730 -0.30663859 -0.28425292\n[21] -0.27878877 -0.25726938 -0.17191736 -0.13332134 -0.10612452\n[26] -0.09465904 -0.06271410  0.03612261  0.20599860  0.36312841\n[31]  0.40426832  0.43281803  0.45545012  0.46009735  0.50495512\n[36]  0.63286260  0.63595040  0.65564788  0.70483734  0.75816324\n[41]  1.03510352  1.21467470  1.30486965  1.32011335  1.37095845\n[46]  1.44410126  1.51152200  1.89519346  2.01842371  2.28664539\n\n$sex\n [1] 1 1 0 1 0 1 1 0 1 0 1 0 1 0 1 1 0 0 0 1 0 1 1 1 1 0 0 1 0 0 0 1 0\n[34] 0 1 1 1 0 0 1 0 0 1 0 0 0 1 1 0 1\n\n$N\n[1] 50\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 50\n   Unobserved stochastic nodes: 5\n   Total graph size: 268\n\nInitializing model\n\n\nTest of\nJAGS model with wrong mean but large variance.\nThe density of sigma shifted significanly.\n\n$b_mass\n [1]  53.8990908  59.4426007  29.5231515  20.7303588  -6.3103379\n [6]  80.9496405  50.8925931  25.3696005  43.5739562  -3.9151883\n[11]  62.1620864  20.9379797  42.8711028  50.2890263  68.2855351\n[16]  83.0771246  15.9433063  44.4534275  63.2445684  21.0932663\n[21]   7.0862415  20.6774554  12.8319806  51.4662785  65.9056104\n[26]  59.5508392  55.8052067  25.0642743  77.2420405  15.1463068\n[31]  34.6591869  41.1748751  29.2184963  37.0053126  54.9988444\n[36]  51.9041366  55.2456198  21.1423585  20.9187584  11.5051759\n[41]  25.6171744  23.2571170 122.7667536   2.5476609  40.2861977\n[46]  -0.1201204  19.2851945  60.6983335  15.1761402  59.1010162\n\n$b_length\n [1] -2.65645542 -2.44046693 -2.41420765 -1.78130843 -1.76316309\n [6] -1.71700868 -1.38886070 -1.36828104 -0.85090759 -0.81139318\n[11] -0.78445901 -0.72670483 -0.63999488 -0.60892638 -0.56469817\n[16] -0.43144620 -0.43046913 -0.36105730 -0.30663859 -0.28425292\n[21] -0.27878877 -0.25726938 -0.17191736 -0.13332134 -0.10612452\n[26] -0.09465904 -0.06271410  0.03612261  0.20599860  0.36312841\n[31]  0.40426832  0.43281803  0.45545012  0.46009735  0.50495512\n[36]  0.63286260  0.63595040  0.65564788  0.70483734  0.75816324\n[41]  1.03510352  1.21467470  1.30486965  1.32011335  1.37095845\n[46]  1.44410126  1.51152200  1.89519346  2.01842371  2.28664539\n\n$sex\n [1] 1 1 0 1 0 1 1 0 1 0 1 0 1 0 1 1 0 0 0 1 0 1 1 1 1 0 0 1 0 0 0 1 0\n[34] 0 1 1 1 0 0 1 0 0 1 0 0 0 1 1 0 1\n\n$N\n[1] 50\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 50\n   Unobserved stochastic nodes: 5\n   Total graph size: 268\n\nInitializing model\n\n\n\n\n\n",
    "preview": "r_posts/2022-08-22-Bayesian/2022-08-22-Bayes_files/figure-html5/unnamed-chunk-6-1.png",
    "last_modified": "2022-08-25T16:14:39-05:00",
    "input_file": "2022-08-22-Bayes.knit.md",
    "preview_width": 1248,
    "preview_height": 768
  },
  {
    "path": "r_posts/2018-05-01-Iowa/",
    "title": "Iowa Pop Characteristics",
    "description": "A descriptive statistics for population in Iowa.",
    "author": [
      {
        "name": "Yiwen Wu",
        "url": {}
      }
    ],
    "date": "2018-05-01",
    "categories": [],
    "contents": "\n\nIntroduction\nThe goal of this study is to look at:\nWhat is the relationships between the population and other\nvariables, such as education attainment, poverty, the mean of income,\nand the median house value.\nVisually display the distribution of median house values across the\nstate, and three frequency distributions based on the population of a\ncounty. All counties are evenly divided into three tiers:\nTier 1: population size from 3,000 to 11,000 (33 counties)\nTier 2: population size form 11,000 to 20,000 (33 counties)\nTier 3: population size form 20,000 to 48,200 (33 counties)\n\nCorrelations between:\nNumber of bechelor received and number of poverty.\nMedian house value and the mean of income.\nNumber of employed and the mean of income.\nNumber of employed and the number under poverty.\n\nT test.\nAll data are collected through the U.S. Census at https://www.census.gov/.\nMethods\nload Packages\nIn order to accomplish these following tasks:\nData manipulation\nCorrelation\nHistogram Visualization\n2-sample t test\nI use the these following packages in R:\n\n\nlibrary(dplyr)\nlibrary(magrittr)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(psych)\nlibrary(Hmisc)\nlibrary(devtools)\n\n\nImport Data\nI used a .csv file to store all collected data from the U.S. Census.\nMy target are 99 counties of the state of Iowa.\n\n\n\nCheck Variables\nBy using head, we are able to check all variables\ncollected for future data analysis. From U.S. Census Data, I collected\nthe following data as my variables: data2010 population, 2017\npopulation, number of bachelor obtained for over 25 year-old, population\ncount that is below poverty, mean of income, and the median house\nvalue\n\n              Id             Geography pop.2010 pop.2017 by.pop\n1 0500000US19003    Adams County, Iowa     4029     3686      1\n2 0500000US19159 Ringgold County, Iowa     5131     5034      1\n3 0500000US19009  Audubon County, Iowa     6119     5578      1\n4 0500000US19143  Osceola County, Iowa     6462     6045      1\n5 0500000US19173   Taylor County, Iowa     6317     6178      1\n6 0500000US19185    Wayne County, Iowa     6403     6476      1\n  Over25.Bach below.poverty median.house mean.income employed\n1         357           418        84900       76251     5935\n2         521           518        79600       77205     3116\n3         414           614        68800       79727    11189\n4         595           689        89500       73473    10108\n5         446           668        76100       74703     4783\n6         416          1001        74700       65938    20110\n\nUnivariate Statistics\nBy running summary, we are able to learn some basic\nstatistics of our dataset. These statistics are range, mean and\nmedian.\n\n      Id             Geography            pop.2010     \n Length:99          Length:99          Min.   :  4029  \n Class :character   Class :character   1st Qu.: 10430  \n Mode  :character   Mode  :character   Median : 15679  \n                                       Mean   : 30771  \n                                       3rd Qu.: 24631  \n                                       Max.   :430640  \n    pop.2017          by.pop   Over25.Bach      below.poverty  \n Min.   :  3686   Min.   :1   Min.   :  357.0   Min.   :  418  \n 1st Qu.:  9977   1st Qu.:1   1st Qu.:  944.5   1st Qu.: 1057  \n Median : 15224   Median :2   Median : 1544.0   Median : 1570  \n Mean   : 31775   Mean   :2   Mean   : 3908.7   Mean   : 3650  \n 3rd Qu.: 25066   3rd Qu.:3   3rd Qu.: 2718.0   3rd Qu.: 2527  \n Max.   :481830   Max.   :3   Max.   :75457.0   Max.   :53570  \n  median.house     mean.income        employed     \n Min.   : 68800   Min.   : 60582   Min.   :  3116  \n 1st Qu.: 91050   1st Qu.: 75504   1st Qu.:  8114  \n Median :107700   Median : 79876   Median : 12194  \n Mean   :113776   Mean   : 81653   Mean   : 24844  \n 3rd Qu.:130600   3rd Qu.: 85658   3rd Qu.: 19728  \n Max.   :218000   Max.   :129274   Max.   :354927  \n\nHistograms and\nDensity/Frequency Distributions\n\n\ny <- my_data$median.house\nhist(y,main = \"Distribution of Median House Value\", xlab = \"Value Range\", \n     xlim = c(0, 220000), col = \"blue\", border =\"black\", prob=TRUE)\nlines(density(y, adjust = 2), col = \"red\")\n\n\n\nRecall: based on the population size, we devide 99 counties into\nthree tiers of counties. 1. Population between 3,000 and 11,000: 33\ncounties - pop1 - Tier 1 2. Population between 11,000 and 20,000: 33\ncounties - pop2 - Tier 2 3. Population between 20,000 and 482,000: 33\ncounties - pop3 - Tier 3\n\n\nx <- my_data$mean.income\nhist(x,main = \"Distribution of Mean of Income\", xlab = \"Income Range\", \n     col = \"blue\", border =\"black\", prob = T )\nlines(density(x, adjust = 2), col = \"red\")\n\n\n\nBased on the population size, I devide 99 counties into three tiers\nof counties.\nPopulation between 3600 and 11000: 33 counties - pop1 - Tier 1\nPopulation between 11000 and 20000: 33 counties - pop2 - Tier 2\nPopulation between 20000 and 482000: 33 counties - pop3 - Tier\n3\n\n\npop1 <- filter(my_data, by.pop == 1)\ny1 <- pop1$mean.income\nhist(y1,main = \"Income Distribution of Counties in the First Tier\", xlab = \"Income Range\",\n     xlim = c(60000, 150000), col = \"blue\", border =\"black\", prob=TRUE)\nlines(density(y1, adjust = 2), col = \"red\")\n\n\n\n\n[1] 76251 77205 79727 73473 74703 65938\n\n\n              Id             Geography pop.2010 pop.2017 by.pop\n1 0500000US19003    Adams County, Iowa     4029     3686      1\n2 0500000US19159 Ringgold County, Iowa     5131     5034      1\n3 0500000US19009  Audubon County, Iowa     6119     5578      1\n4 0500000US19143  Osceola County, Iowa     6462     6045      1\n5 0500000US19173   Taylor County, Iowa     6317     6178      1\n6 0500000US19185    Wayne County, Iowa     6403     6476      1\n  Over25.Bach below.poverty median.house mean.income employed\n1         357           418        84900       76251     5935\n2         521           518        79600       77205     3116\n3         414           614        68800       79727    11189\n4         595           689        89500       73473    10108\n5         446           668        76100       74703     4783\n6         416          1001        74700       65938    20110\n\n\n\npop2 <- filter(my_data, by.pop == 2)\ny2 <- pop2$mean.income\nhist(y2,main = \"Income Distribution of Counties in the Second Tier\", xlab = \"Income Range\", \n     xlim = c(60000, 150000), col = \"blue\", border =\"black\", prob=TRUE)\nlines(density(y2, adjust = 2), col = \"red\")\n\n\n\n\n\npop3 <- filter(my_data, by.pop == 3)\ny3 <- pop3$mean.income\nhist(y3,main = \"Income Distribution of Counties in the Third Tier\", xlab = \"Income Range\",\n     xlim = c(60000, 150000), col = \"blue\", border =\"black\", prob=TRUE)\nlines(density(y3, adjust = 2), col = \"red\")\n\n\n\nConlusion\nBased on the frequency distribution, as the size of population of a\ncounty increaces, the average income tends to increase.\nCorrelation\nbetween number of bachelor over 25 in age and number under poverty\nNormally, we would expact the correlation between number of bechalor\ndegrees obtained and the number of people under poverty. However, the\ntruth can be: the more bechalors a county has, the bigger population it\nmay have. Therefore, it is more likely to have more people under\npoverty.\n\n\ncorrelation1 <- cor(my_data$Over25.Bach, my_data$below.poverty, \n                   method = c(\"pearson\"))\ncorrelation1\n\n[1] 0.9541034\n\nCorrelation\nbetween median house value and mean of income.\nThere is a strong positive correlation between median house value and\nthe average income.\n\n[1] 0.8414412\n\nCorrelation\nbetween number of employed and mean of income.\nIt is very likely that there is no correlation between number of\nemployed and the mean of income.\n\n[1] 0.04853983\n\nCorrelation\nbetween number of employed and number under poverty.\nIt is very likely that there is no correlation between number of\nemployed and the number under poverty\n\n\ncorrelation4 <- cor(my_data$employed, my_data$below.poverty, \n                    method = c(\"pearson\"))\ncorrelation4\n\n[1] -0.004254535\n\nT- test\nNull: the means of income are the same.\nAlternative: they are not the same.\n\n\n    Two Sample t-test\n\ndata:  my_data$pop.2017 and my_data$mean.income\nt = -8.3951, df = 196, p-value = 9.212e-15\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -61594.95 -38160.87\nsample estimates:\nmean of x mean of y \n 31774.86  81652.77 \n\nThe p-value is smaller than 0.05. There is significant evidence to\nreject the null hypothesis. The means of income are not the same for\ncounties with different population sizes.\n\n\n\n",
    "preview": "r_posts/2018-05-01-Iowa/2018-05-01-Iowa_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-08-23T22:45:14-05:00",
    "input_file": {},
    "preview_width": 1248,
    "preview_height": 768
  }
]
